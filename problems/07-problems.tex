\documentclass[a4paper,10pt,landscape,twocolumn]{scrartcl}

%% Settings
\newcommand\problemset{7}
\newcommand\worksession{Tuesday, 3 October 2017}
\newif\ifcomments
\commentsfalse % hide comments
%\commentstrue % show comments

%% Packages
\usepackage[english]{exercises}
\usepackage{wasysym}
\usepackage{hyperref}
\hypersetup{colorlinks=true, urlcolor = blue, linkcolor = blue}
\usepackage{enumitem}

%% Macros
\input{macros}



\begin{document}

\problems

{\sffamily\noindent
We will work on the following exercises together during the work sessions on \worksession.

You are strongly encouraged to work together on the exercises, including the homework. You do not have to hand in solutions to these problem sets.}

\begin{exercise}[Short tags]
Say $\Pi=(\mathsf{Gen},\mathsf{Mac},\mathsf{Vrfy})$ is a secure MAC, and for $k\in\{0,1\}^n$ the tag-generation algorithm $\mathsf{Mac}_k$ always outputs tags of length $t(n)$. Prove that $t$ must be super-logarithmic or, equivalently, that if $t(n)=O(\log n)$ then $\Pi$ cannot be a secure MAC

\textbf{Hint:} Consider the probability of randomly guessing a valid tag.
\end{exercise}

\begin{exercise}[A simple MAC from a PRF ]
Consider the following MAC for messages of length $\ell(n)=2n-2$ using a pseudorandom function $F$: On input a message $m_0\Vert m_1$ (with $|m_0|=|m_1|=n-1$) and key $k\in\{0,1\}^n$, algorithm $\mathsf{Mac}$ outputs $t=F_k(0\Vert m_0)\Vert F_k(1\Vert m_1)$. Algorithm $\mathsf{Vrfy}$ is defined in the natural way. Is $(\mathsf{Gen},\mathsf{Mac},\mathsf{Vrfy})$ secure? Prove your answer.
\end{exercise}

\begin{exercise}[Modified CBC-MAC ]
  Prove that the following modifications of basic CBC-MAC do not yield a
secure MAC (even for fixed-length messages):
\begin{enumerate}
\item \mac outputs all blocks $t_1, \ldots , t_\ell$, rather than just $t_\ell$. (Verification only checks whether $t_\ell$ is correct.)
\item A random initial value is used each time a message is authenticated. That is, $t_0 \in \{0, 1\}^n$ is chosen uniformly at random rather than being fixed to $0^n$, and the tag is $\langle t_0, t_\ell \rangle$. Verification is done in the natural way.
\end{enumerate}
\end{exercise}

\begin{exercise}[A randomized variable-length MAC from a PRF]

Let $F$ be a pseudorandom function. Show that the following MAC is insecure for variable-length messages. $\mathsf{Gen}$ outputs a uniform $k\in\{0,1\}^n$. Let $\langle i\rangle$ denote an $n/2$-bit encoding of the integer $i$.

To authenticate a message $m=m_1\|\dots\| m_{\ell}$, where $m_i\in\{0,1\}^{n/2}$, choose a uniform $r\gets\{0,1\}^n$, compute $t:=F_k(r)\oplus F_k(\langle 1\rangle\Vert m_1)\oplus\cdots\oplus F_k(\langle \ell\rangle\Vert m_{\ell})$ and let the tag be $( r,t)$.

\end{exercise}

\begin{bonusexercise}[Appending the message length in CBC-MAC ]
Show that appending the message length to the \emph{end} of the message before applying basic CBC-MAC does not result in a secure MAC for arbitrary-length messages.
\end{bonusexercise}


\end{document}
