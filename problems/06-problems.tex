\documentclass[a4paper,10pt,landscape,twocolumn]{scrartcl}

%% Settings
\newcommand\problemset{6}
\newcommand\worksession{Friday, 29 September 2017}
\newif\ifcomments
\commentsfalse % hide comments
%\commentstrue % show comments

%% Packages
\usepackage[english]{exercises}
\usepackage{wasysym}
\usepackage{hyperref}
\hypersetup{colorlinks=true, urlcolor = blue, linkcolor = blue}
\usepackage{enumitem}

%% Macros
\input{macros}



\begin{document}

\problems

{\sffamily\noindent
We will work on the following exercises together during the work sessions on \worksession.

You are strongly encouraged to work together on the exercises, including the homework. You do not have to hand in solutions to these problem sets.}

\begin{exercise}[Exercise~3.20 from  $\text{[KL]}$ ]
  Consider a stateful variant of CBC-mode encryption where the sender simply increments the $IV$ by 1 each time a message is encrypted (rather than choosing $IV$ at random each time). Show that the resulting scheme is \emph{not} CPA-secure.
\end{exercise}

\begin{exercise}[Exercise~3.28 from $\text{[KL]}$ ]
Show that the CBC, OFB, and CTR modes of operation do not yield CCA-secure encryption schemes (regardless of $F$). Consider encryptions and decryptions of only single block messages.
\end{exercise}

\begin{exercise}[Exercise~3.29 from $\text{[KL]}$ ]
  Let $\Pi_1 = (\enc_1, \dec_1)$ and $\Pi_2 = (\enc_2, \dec_2)$ be two encryption schemes for which it is known that at least one is CPA-secure (but you don't know which one). Show how to construct an encryption scheme $\Pi$ that is guaranteed to be CPA-secure as long as at least one of $\Pi_1$ or $\Pi_2$ is CPA-secure. Provide a full proof of your solution.

  \textbf{Hint:} Generate two plaintext messages from the original plaintext so that knowledge of either one reveals nothing about the original plaintext, but knowledge of both enables the original plaintext to be computed.
\end{exercise}


\begin{bonusexercise}[Exercise~3.26 from $\text{[KL]}$ ]
  For any function $g : \{0, 1\}^n \to \{0, 1\}^n$ , define $g^{\$} (Â·)$ to be a probabilistic oracle that, on input $1^n$, chooses uniform $r \in \{0, 1\}^n$ and returns $\langle r, g(r)\rangle$. A keyed function $F$ is a \emph{weak pseudorandom function} if for all PPT algorithms $D$, there exists a negligible function $\mathsf{negl}$ such that:
  \begin{equation}
  \left\lvert  \text{Pr}[ D^{F_k^{\$}(.)}(1^n)=1 ]-\text{Pr}[ D^{f^{\$}(.)}(1^n)=1 ]  \right\rvert < \mathsf{negl}(n),
  \end{equation}
where $k \in \{0, 1\}^n$ and $f \in \mathsf{Func}_n$ are chosen uniformly.
\begin{enumerate}[label=(\alph*)]
\item Prove that if $F$ is pseudorandom then it is weakly pseudorandom.
\item Let $F'$ be a pseudorandom function, and define
\begin{equation}
F_k(x):=\begin{cases}
    F'_k(x)     & \quad \text{if } x \text{ is even}\\
    F'_k(x+1)  & \quad \text{if } x \text{ is odd.}
  \end{cases}
\end{equation}
Prove that $F$ is weakly pseudorandom, but \emph{not} pseudorandom.
\item Is CTR-mode encryption using a weak pseudorandom function necessarily CPA-secure? Does it necessarily have indistinguishable encryptions in the presence of an eavesdropper? Prove your answers.

 \textbf{Hint:} Consider CTR-mode using $F$ defined above, show an attack on this encryption scheme.
\item Prove that Construction 3.30 is CPA-secure if $F$ is a weak pseudorandom function.
\end{enumerate}
\end{bonusexercise}


\end{document}
