\documentclass{article}

\usepackage{amsmath, amssymb}
\usepackage{dsfont}
\usepackage[colorlinks=true,urlcolor=webblue,linkcolor=webgreen,filecolor=webblue,citecolor=webgreen,pdfpagemode=UseOutlines,pdfstartview=FitH,pdfpagelayout=OneColumn,bookmarks=true]{hyperref}
\usepackage{fullpage}
\usepackage{enumerate}
\usepackage{tikz}
\usepackage[numbers]{natbib}


\definecolor{webgreen}{rgb}{0,.5,0}
\definecolor{webblue}{rgb}{0,0,.5}

\newtheorem{defn}{Definition}
\newtheorem{sdefn}{Supplemental Definition}
\newtheorem{thm}[defn]{Theorem}
\newtheorem{prop}[defn]{Proposition}
\newtheorem{cor}[defn]{Corollary}
\newtheorem{lem}[defn]{Lemma}
\newtheorem{rem}[defn]{Remark}
\newtheorem{ex}[defn]{Example}
\numberwithin{defn}{section}
\numberwithin{equation}{section}


\def\RR{\mathbbm{R}}
\def\minimize{\textrm{minimize}}
\def\st{\textrm{subject to }}
\def\maximize{\textrm{maximize}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}


\newcommand{\id}{\mathrm{id}}
\newcommand{\sbullet}{\,\begin{picture}(1,1)(-0.5,-2)\circle*{3}\end{picture}\,}
\newcommand{\de}[1]{\left( #1 \right)}
\newcommand{\De}[1]{\left[ #1 \right]}
\newcommand{\DE}[1]{\left\{ #1 \right\}}
\renewcommand{\Re}[1]{{\mathrm{Re}}\de{#1}}
\renewcommand{\Im}[1]{{\mathrm{Im}}\de{#1}}
\newcommand{\ket}[1]{| #1 \rangle}
\newcommand{\bra}[1]{\langle #1 |}
\newcommand{\braket}[2]{\left\langle #1 \mid #2 \right\rangle}
\newcommand{\ketbra}[2]{\left|#1\right\rangle\!\!\left\langle #2\right|}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\mean}[1]{\left\langle #1 \right\rangle}
\newcommand{\op}[1]{{\mathbf{#1}}}
\newcommand{\supop}[1]{{\mathcal{#1}}}
\newcommand{\esp}[1]{{\mathsf{#1}}}
\newcommand{\sen}{\mathrm{sen}}
\newcommand{\tr}{\mathrm{Tr}}
\newcommand{\meanop}[1]{\mean{\op{#1}}}
\newcommand{\sig}{\op{\sigma}}
\newcommand{\s}{\op{S}}
\newcommand{\CCC}{{\mathbb{C}}^2\otimes{\mathbb{C}}^2\otimes{\mathbb{C}}^2}
\newcommand{\Part}{\mathcal{P}}
\newcommand{\eg}{{\it{e.g.~}}}
\newcommand{\ie}{{\it{i.e.~}}}
\newcommand{\etal}{{\it{et al.}}}
\newcommand{\proj}[1]{\ensuremath{|#1\rangle \langle #1|}}

\providecommand{\openone}{\mathbbm{1}}
\renewcommand{\rho}{\varrho}
\newcommand{\msc}[1]{{\scriptstyle #1}}
\newcommand{\D}{\mathrm{d}}
\newcommand{\supp}{\mathrm{supp}}
\newcommand{\im}{\mathrm{im}}
\newcommand{\spa}{\mathrm{span}}
\newcommand{\spec}{\mathrm{spec}}
\newcommand{\Hom}{\mathrm{Hom}}
\newcommand{\sh}{\mathrm{sh}}
\newcommand{\Hi}{\mathcal{H}}
\newcommand{\St}{\mathbb{S}}
\newcommand{\hi}{\Hi}
\newcommand{\sos}[1]{\mathbb{S}\left(#1\right)}
\newcommand{\End}[1]{\mathrm{End}\left(#1\right)}
\newcommand{\ot}{\otimes}
\newcommand{\eps}{\varepsilon}
\newcommand{\one}{\mathds 1}

% operators on a hilbert space
\newcommand{\opr}{\mathcal B}

%entropies
\newcommand{\relent}[4]{D_{#1}\left( #3 #2\| #4\right)}
\newcommand{\imax}[3]{I^{#1}_{\max}\left(#2:#3\rihgt)}
\newcommand{\hmax}{H_{\max}}
\newcommand{\hmin}{H_{\min}}

\newenvironment{notebox} % for framing notes/thoughts etc during writing
{\begin{framed}\begin{small}}
{\end{small}\end{framed}}


% some frequently used acronyms
\newcommand{\SKQES}{\textsf{QES}}
\newcommand{\ITS}{\textsf{ITS}}
\newcommand{\IND}{\textsf{IND}}
\newcommand{\ITNM}{\textsf{NM}}
\newcommand{\ABWNM}{\textsf{ABW-NM}}
\newcommand{\ABW}{\textsf{ABW}}
\newcommand{\DNS}{\textsf{DNS}}
\newcommand{\GYZ}{\textsf{GYZ}}
\newcommand{\acc}{\textsf{acc}}
\newcommand{\rej}{\textsf{rej}}
%linked refs
\newcommand{\expref}[2]{\texorpdfstring{\hyperref[#2]{#1~\ref{#2}}}{#1~\ref{#2}}}


\hyphenation{modu-lus en-tan-gle-mentmal-le-a-bi-li-ty}



%%% added by GA 
\newcommand{\KeyGen}{\ensuremath{\mathsf{KeyGen}}}
\newcommand{\Enc}{\ensuremath{\mathsf{Enc}}}
\newcommand{\Dec}{\ensuremath{\mathsf{Dec}}}
\newcommand{\Mac}{\ensuremath{\mathsf{Mac}}}
\newcommand{\Ver}{\ensuremath{\mathsf{Ver}}}
\newcommand{\MAC}{\operatorname{MAC}}
\newcommand{\poly}{\operatorname{poly}}
\newcommand{\ttag}{\Pi^{\operatorname{tag}}_t}

% make a proper TOC despite llncs
\setcounter{tocdepth}{3}
\makeatletter
%\renewcommand*\l@author[2]{}
%\renewcommand*\l@title[2]{}
\makeatletter


\makeindex

\newcommand{\MB}[1]{\textcolor{red}{#1}}
\newcommand{\CM}[1]{\textcolor{blue}{\emph{(CM: #1)}}}

\bibliographystyle{plainnat}
%-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

%\title{Quantum non-malleability and authentication}
%\author{} \institute{}
%\pagestyle{plain}
%\date{\today}
%\author{Gorjan Alagic \and Christian Majenz}
%\institute{QMATH, Department of Mathematical Sciences\\ University of Copenhagen\\~\\ \email{galagic@gmail.com} \qquad \email{majenz@math.ku.dk}}

%-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\begin{document}
\section*{Solutions to the homework exercises}

\subsection*{Homework 7}


	\subsubsection*{Question 2:} The security definition is pretty much the same as in the fixed length case: The adversary is granted access to an authentication oracle, this time for arbitrary length messages. She is then asked to produce a forgery, i.e. a message-tag-pair that has not been previously output by the oracle. Note that the message length of the forgery is allowed to be different from any of the messages sent to the oracle.
	
	The attack works as follows. 
\begin{itemize}
\item Query some $m_1$, $|m_1|=n$, the oracle outputs $( m_1,t )$.
\item The forgery is $(m^*,t^*)=( m_1\| m_1\oplus t,t )$
\end{itemize}	
The attack works because $m_1\| m_1\oplus t\neq m_1$ and $( m_1\| m_1\oplus t,t )$ is a valid message-tag pair. To be more precise $\MAC_k(m*)=F_k( F_k(m_1)\oplus (m_1\oplus t ))=F_k( t\oplus m_1\oplus t )=F_k(m_1)=t$.
	
	\subsubsection*{Question 3:}
The attack works as follows. 
\begin{itemize}
\item Query $m_1\|m_2\|m_3$, where all $m_i$ are distinct and $|m_i|=n$, the oracle outputs $(m_1\|m_2\|m_3,t )$.
\item The forgery is $(m^*,t^*)=( m_1\|m_3\|m_2,t )$
\end{itemize}	
The attack works because $m_1\|m_3\|m_2\neq m_1\|m_2\|m_3$, $m_i$ are distinct, and $\MAC_k(m_1\|m_3\|m_2)=F_k(m_1)\oplus F_k(m_3)\oplus F_k(m_2)=F_k(m_1)\oplus F_k(m_2)\oplus F_k(m_3) =t$.

\subsubsection*{Question 4:}
The attack works as follows. 
\begin{itemize}
\item Query $m_1\|m_2\|m_3$ and $m_4\|m_5\|m_6$ where all $m_i$ are distinct and $|m_i|=n$, the oracle outputs $( m_1\|m_2\|m_3,t_1)$ and $( m_4\|m_5\|m_6,t_2)$.
\item Query $m_1\|m_2\|m_6$, the oracle outputs $(m_1\|m_2\|m_6,t_3)$.
\item The forgery is $(m^*,t^*)=( m_4\|m_5\|m_3,t_1\oplus t_2\oplus t_3 )$
\end{itemize}	
The attack works because $m_4\|m_5\|m_3\not\in \{m_1\|m_2\|m_3, m_4\|m_5\|m_6,m_1\|m_2\|m_6 \}$, and
\begin{align*}
\MAC_k(m^*)=&F_k(\langle 1\rangle \|m_4)\oplus F_k(\langle 2\rangle \|m_5)\oplus F_k(\langle 3\rangle \|m_3)\\
=& \underset{t_2}{\underbrace{F_k(\langle 1\rangle \|m_4)\oplus F_k(\langle 2\rangle \|m_5)\oplus F_k(\langle 3\rangle \|m_6)}} \oplus \underset{t_1\oplus t_3}{\underbrace{F_k(\langle 3\rangle \|m_6)\oplus F_k(\langle 3\rangle \|m_3)}}.
\end{align*}

\subsubsection*{Question 5:}
The attack works as follows. 
\begin{itemize}
\item Query $m_1\|m_2$ and $m_3\|m_4$ where all $m_i$ are distinct and $|m_i|=n$, the oracle outputs $( m_1\|m_2,t_1\| t_2)$ and $( m_3\|m_4 ,t_3\|t_4)$.
\item The forgery is $(m^*,t^*)=( m_1\|m_4,t_1\| t_4 )$
\end{itemize}	
The attack works because $m_1\|m_4 \not\in \{m_1\|m_2, m_3\|m_4 \}$, and $t_1=F_k(m_1)$, $t_4=F_k(F_k(m_4))$, so finally we have that $\MAC_k(m^*)=F_k(m_1)\|  F_k(F_k(m_4))=t_1\|t_4$. 

%---------------------------------------------------------------------%
%---------------------------------------------------------------------%
\end{document}
%---------------------------------------------------------------------%
%---------------------------------------------------------------------%


